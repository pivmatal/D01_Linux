## Part 1. Установка ОС

##### Установить **Ubuntu 20.04 Server LTS** без графического интерфейса. (Используем программу для виртуализации - VirtualBox)

- Графический интерфейс должен отсутствовать.

- Узнайте версию Ubuntu, выполнив команду \
`cat /etc/issue.`
- Вставьте скриншот с выводом команды:
![exercise_1](screenshot/part1.png)

## Part 2. Создание пользователя

- создание пользователя происходит с помощью команды: 
`sudo adduser <имя нового пользователя>`
![exercise_2.1](screenshot/part2.1.png)

- в результате вывода команды `cat /etc/passwd` можно увидеть нового пользователя:
![exercise_2.2](screenshot/part2.2.png)

- далее добавляем пользователя в группу adm с помощью команды `sudo usermod -a -G adm`:
![exercise_2.3](screenshot/part2.3.png)

## Part 3. Настройка сети ОС

- изначально название машины было "user":
![exercise_3.1](screenshot/part3.1.png)

- командой `sudo hostname user-1` поменяли название и проверили:
![exercise_3.2](screenshot/part3.2.png)

- устанавливаем временную зону, которая соответствует моему местоположению командой `sudo timedatectl set-timezone Asia/Novosibirsk` предварительно узнав корректное название зоны
![exercise_3.3](screenshot/part3.3.png)

- командой `ifconfig` выводим названия наших сетевых интерфейсов:
![exercise_3.4](screenshot/part3.4.png)

- интерфейс lo нужен для того чтобы отлаживать сетевые программы и запускать серверные приложения на локальном компьютере без подключения внешней сети. К интерфейсу привязан адрес 127.0.0.1
- ip адрес устройства на котором я работаю можно узнать с помощью команды `hostname -I`
![exercise_3.5](screenshot/part3.5.png)

- >DHCP — сетевой протокол, позволяющий сетевым устройствам автоматически получать IP-адрес и другие параметры, необходимые для работы в сети TCP/IP. Данный протокол работает по модели «клиент-сервер».

- Выведем на экран внутренний IP-адрес шлюза и внешний ip-адрес шлюза (ip)  с помощью команд `curl ifconfig.me` и `ip route` соответственно
![exercise_3.6](screenshot/part3.6.png)

- Зададим статичные настройки ip, gw и dns. Для этого я использовал редактор vim и команду `sudo vim /etc/netplan/00-installer-config.yaml`
![exercise_3.8](screenshot/part3.8.png)

  - addresses — ip адрес который будет назначен нашей сетевой карте.
  - gateway4 — ip адрес нашего роутера.
  - nameservers — адрес DNS сервера.

- перезагружаем машину и убеждаемся что статичные сетевые настройки (ip, gw, dns) соответствуют заданным в предыдущем пункте
![exercise_3.9](screenshot/part3.9.png)
![exercise_3.10](screenshot/part3.10.png)

- далее пингуем адрес 1.1.1.1 и получаем сообщение "0% packet loss"
![exercise_3.11](screenshot/part3.11.png)

- также пингуем адрес ya.ru и получаем то же сообщение:
![exercise_3.12](screenshot/part3.12.png)


## Part 4. Обновление ОС

- Проверяем наличие обновлений командой `sudo apt update`:
![exercise_4.1](screenshot/part4.1.png)

- Далее командой `sudo apt upgrade` обновлем пакеты:
![exercise_4.2](screenshot/part4.2.png)

- Убеждаемся что все пакеты обновлены:
![exercise_4.3](screenshot/part4.3.png)

## Part 5. Использование команды **sudo**

- Разрешаем пользователю user_two, созданному в Part 2, выполнять команду sudo:
![exercise_5.1](screenshot/part5.1.png)

- >Команда sudo предоставляет возможность пользователям выполнять команды от имени суперпользователя root, либо других пользователей.

- Поменяем hostname ОС от имени пользователя, созданного в  Part 2 (используя sudo). Сначала перезайдем под пользователем user_two (`su - user_two`) и командой `sudo hostnamectl set-hostname user_two-1` поменяем имя хоста:
![exercise_5.2](screenshot/part5.2.png)

- перезапустим машину и убедимся в том что имя изменено:
![exercise_5.3](screenshot/part5.3.png)

## Part 6. Установка и настройка службы времени

- Выведем время и часовой пояс в котором мы находимся, командами `date` и `cat /etc/timezone`:
![exercise_6.1](screenshot/part6.1.png)

- Вывод следующей команды содержит `NTPSynchronized=yes`: \
  `timedatectl show`
![exercise_6.2](screenshot/part6.2.png)

- Командой `timedatectl set-ntp on` настроим службу автоматической синхронизации времени:
![exercise_6.3](screenshot/part6.3.png)

## Part 7. Установка и использование текстовых редакторов 

- Используя редакторы vim,nano и joe, отредактируем файл *test_X.txt*, где X -- название редактора. Напишем в нём свой никнейм, закроем файл с сохранением изменений. 
  
  - Чтобы сохранить файл и выйти из редактора vim, нажмем Esc чтобы переключиться в обычный режим, введем :wq и нажмем Enter:
![exercise_7.1](screenshot/part7.1.png)

  - Для сохранения и выхода из nano нажмем CTRL + O и нажмем ENTER, чтобы сохранить изменения, далее чтобы выйти из nano, достаточно нажать CTRL + X.
![exercise_7.2](screenshot/part7.2.png)

  - Чтобы сохранить файл и выйти из редактора joe, нужно использовать Ctrl+K, а затем клавишу X.
![exercise_7.3](screenshot/part7.3.png)


- Используя каждый из трех выбранных редакторов, откроем файл на редактирование, отредактируйем файл, заменив никнейм на строку "21 School 21" и закроем файл без сохранения изменений.
  - Чтобы выйти из редактора vim без сохранения, нажмем Esc чтобы переключиться в обычный режим, введем :qa! и нажмем Enter:
![exercise_7.4](screenshot/part7.4.png)

  - Для выхода из nano, достаточно нажать CTRL + X.
![exercise_7.5](screenshot/part7.5.png)

  - Чтобы  выйти из редактора joe без сохранения нужно использовать комбинацию Ctrl+С.
![exercise_7.6](screenshot/part7.6.png)

- Используя каждый из трех выбранных редакторов, отредактируем файл ещё раз (по аналогии с предыдущим пунктом), а затем освоим функции поиска по содержимому файла (слово) и замены слова на любое другое.

  - В vim для поиска и замены вводим команду `%s/\School\>/qarltonh/g` где School - искомое, а qarltonh заменяемое.
![exercise_7.8](screenshot/part7.8.png)

  - В nano для поиска и замены нажмем Ctrl+\\, введем строку, которую необходимо искать ( School ) и нажмите клавишу Enter. Затем введем строку, на которую произвести замену ( qarltonh ) и нажмем Enter
![exercise_7.10](screenshot/part7.10.png)

  - В joe для поиска вхождения нажимаем Ctrl+K затем f, после вводим School (искомое) и ENTER подтверждаем замену r, вводим qarltonh(замена) и подтверждаем y.
![exercise_7.12](screenshot/part7.12.png)

## Part 8. Установка и базовая настройка сервиса **SSHD**

- Установим службу SSHd.
![exercise_8.2](screenshot/part8.2.png)

- Проверим работу службу SSHd.
![exercise_8.3](screenshot/part8.3.png)

- Добавим автостарт службы при загрузке системы.
![exercise_8.4](screenshot/part8.4.png)

- Перенастроим службу SSHd на порт 2022. Для этого внесем изменнения в файл /etc/ssh/sshd_config
![exercise_8.5](screenshot/part8.5.png)

- Используя команду ps, покажем наличие процесса sshd. Для этого к команде нужно подобрать ключи.
  -  ps Выводит процессы, выполняющиеся в настоящее время от имени пользователя
  - Флаги:
    - aux Выводятся все процессы, выполняющиеся от имени всех пользователей (выводит статистику, время старта процесса и команду, которая его стартовала);
    - -e Все выполняющиеся процессы в системе;
    - -A, -e, (a) - выбрать все процессы;
    - -a - выбрать все процессы, кроме фоновых;
    - o	-d, (g) - выбрать все процессы, даже фоновые, кроме процессов сессий;
    - -N - выбрать все процессы кроме указанных;
    - -С - выбирать процессы по имени команды;
    - -G - выбрать процессы по ID группы;
    - -p, (p) - выбрать процессы PID;
    - --ppid - выбрать процессы по PID родительского процесса;
    - -s - выбрать процессы по ID сессии;
    - -t, (t) - выбрать процессы по tty;
    - -u, (U) - выбрать процессы пользователя.

- Выведем результат команды `ps aux | grep [s]sh`
![exercise_8.7](screenshot/part8.7.png)

- Проверим работу службу SSHd после перезагрузки:
![exercise_8.6](screenshot/part8.6.png)

- Вывод команды `netstat -tan` должен содержать  \
`tcp 0 0 0.0.0.0:2022 0.0.0.0:* LISTEN`:
![exercise_8.9](screenshot/part8.9.png)

- Ключи команды netstat:
        - -t - протокол обмена данными для отчёта, tcp в этом случае
        - -a - отображение всех подключений и ожидающих портов
        - -n - отображение IP-адресов и номеров портов в цифровом виде
    - Proto - используемый протокол обмена данными, по ключу -t выбран tcp 
    - Recv-Q - количество байт, не скопированных программой пользователя, подключенной к этому сокету(это данные которые приняты хостом и ожидающие обработки программой).
    - Send-Q - Количество байт, не подтвержденных удаленным хостом.
    - Local Address - адрес и номер порта локального конца сокета.
    - Foreing Address - адрес и номер порта удаленного конца сокета.
    - State - состояние сокета TCP (LISTEN - ожидает входящих соединения, т.е. открыт).
    - IP-адрес 0.0.0.0 может использоваться на серверах для обозначения того, что служба может связываться со всеми сетевыми интерфейсами. Он дает команду серверу «прослушивать» и принимать соединения с любого IP-адреса.

## Part 9. Установка и использование утилит **top**, **htop**

- Запустим утилиту top
![exercise_9.1](screenshot/part9.1.png)
    - uptime: `18:40:40 up 15 min`
    - количество авторизованных пользователей: `1 user`
    - общая загрузка системы: `load average 0.42, 0.46, 0.23 `
    - общее количество процессов: `94 total`
    - загрузка cpu: `%Cpu(s): 0.0 us, 0.0 sy 0.0 ni, 100.0 id, 0.0 wa, 0.0 hi, 0.0 si, 0.0 st`
    - загрузка памяти: `MiB Mem: 1983.4 total, 1462.3 free, 146.5 used, 374.6 buuf/cache`
    - pid процесса занимающего больше всего памяти:
    ![exercise_9.2](screenshot/part9.2.png)
    - pid процесса, занимающего больше всего процессорного времени:
    ![exercise_9.3](screenshot/part9.3.png)

- Вывод команды `htop`:
![exercise_9.4](screenshot/part9.4.png)
  - отсортированное по PID:
![exercise_9.4](screenshot/part9.4.png)
  - отсортированное по PERCENT_CPU:
![exercise_9.5](screenshot/part9.5.png)
  - отсортированное по PERCENT_MEM:
![exercise_9.6](screenshot/part9.6.png)
  - отсортированное по TIME:
![exercise_9.7](screenshot/part9.7.png)
  - отфильтрованное для процесса sshd:
![exercise_9.8](screenshot/part9.8.png)
  - с процессом syslog, найденным, используя поиск:
![exercise_9.9](screenshot/part9.9.png)
  - с добавленным выводом hostname, clock и uptime:
![exercise_9.10](screenshot/part9.10.png)

## Part 10. Использование утилиты **fdisk**

- Запустим команду `fdisk -l`.
![exercise_10.1](screenshot/part10.1.png)
    - название диска: `VBOX HARDDISK`
    - размер: `11.28GB`
    - кол-во секторов: `23638016`
    - размер swap выведем командой `swapon --show`: 
![exercise_10.2](screenshot/part10.2.png)

## Part 11. Использование утилиты **df** 

- Запустим команду `df`:
![exercise_11.1](screenshot/part11.1.png)
- для корневого раздела (/):
    - размер раздела: `9718576 кб`
    - размер занятого пространства: `4519672 кб`
    - размер свободного пространства: `4683628 кб`
    - процент использования: `50%`

- Запустим команду `df -Th`:
![exercise_11.2](screenshot/part11.2.png)
для корневого раздела (/):
    - размер раздела: `9.3 Гб`
    - размер занятого пространства: `4.4 Гб`
    - размер свободного пространства: `4.5 Гб`
    - процент использования: `50%`
    - тип файловой системы для раздела: `ext4`

## Part 12. Использование утилиты **du**

- Запустим команду `du`:
![exercise_12.1](screenshot/part12.1.png)

- Выведем размер папок /home, /var, /var/log (в байтах, в человекочитаемом виде): 
  - размер папки /home:
![exercise_12.2](screenshot/part12.2.png)
![exercise_12.3](screenshot/part12.3.png)
  - размер папки /var:
![exercise_12.4](screenshot/part12.4.png)
![exercise_12.5](screenshot/part12.5.png)
  - размер папки /var/log:
![exercise_12.6](screenshot/part12.6.png)
![exercise_12.7](screenshot/part12.7.png)

- Выведем размер всего содержимого в /var/log (не общее, а каждого вложенного элемента, используя *):
![exercise_12.8](screenshot/part12.8.png)

## Part 13. Установка и использование утилиты **ncdu**

- Установим утилиту `ncdu`:
![exercise_13.1](screenshot/part13.1.png)

- Выведем размер папок /home, /var, /var/log:
    - Выведем размер папки /home:
![exercise_13.2](screenshot/part13.2.png)
    - Выведем размер папки /var:
![exercise_13.3](screenshot/part13.3.png)  
    - Выведем размер папки /var/log:
![exercise_13.4](screenshot/part13.4.png)

## Part 14. Работа с системными журналами

- Откроем для просмотра:
  - /var/log/dmesg
![exercise_14.1](screenshot/part14.1.png)
  - /var/log/syslog
![exercise_14.2](screenshot/part14.2.png)
  - /var/log/auth.log 
![exercise_14.3](screenshot/part14.3.png) 

- Узнаем время последней успешной авторизации, имя пользователя и метод входа в систему:
![exercise_14.4](screenshot/part14.4.png)
  - время последней успешной авторизации: Feb 16 14:19:40
  - имя пользователя: user
  - метод входа в систему: login
  
- Перезапустим службу SSHd:
![exercise_14.5](screenshot/part14.5.png)


- Cообщение о рестарте службы:
![exercise_14.6](screenshot/part14.6.png)

 ## Part 15. Использование планировщика заданий **CRON**

- Используя планировщик заданий, запустим команду uptime через каждые 2 минуты.
- Для начала внесем скрипт в планировщик командой `crontab -e`
![exercise_15.1](screenshot/part15.1.png)

- проверим выполнение команды `uptime` с интервалом 2 минуты: `tail /var/log/syslog | grep "CRON"`:
![exercise_15.2](screenshot/part15.2.png)

- Выведем на экран список текущих заданий для CRON командой `crontab -l`:
![exercise_15.3](screenshot/part15.3.png)

-  Удалим все задания из планировщика: `crontab -r`:
![exercise_15.4](screenshot/part15.4.png)